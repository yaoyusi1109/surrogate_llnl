n <- 50
x <- seq(0, 1, length = n)
dx <- sq_dist(x)
tau2 <- 1
theta <- 1
deepgp:::Matern
n <- 50
x <- seq(0, 1, length = n)
dx <- sq_dist(x)
tau2 <- 1
theta <- 1
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
library(deepgp)
n <- 50
x <- seq(0, 1, length = n)
dx <- sq_dist(x)
tau2 <- 1
theta <- 1
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- mvtnorm::rmvnorm(5, mean = rep(0, n), sigma = K)
matplot(x, wprior)
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(5, mean = rep(0, n), sigma = K))
matplot(x, wprior, type = "l")
library(deepgp)
reps <- 10
n <- 50
x <- seq(0, 1, length = n)
warp_ord <- order(x, decreasing = FALSE)
dx <- sq_dist(x)
tau2 <- 1
theta <- 1
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- matrix(nrow = n, ncol = reps)
for (i in 1:reps)
wwarp[, i] <- deepgp:::monotransform(wwarp[, i], warp_ord)
library(deepgp)
reps <- 10
n <- 50
x <- seq(0, 1, length = n)
warp_ord <- order(x, decreasing = FALSE)
dx <- sq_dist(x)
tau2 <- 1
theta <- 1
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- matrix(nrow = n, ncol = reps)
for (i in 1:reps)
wwarp[, i] <- deepgp:::monotransform(wwarp[, i], warp_ord)
par(mfrow = c(1, 2))
matplot(x, wprior, type = "l", main = "Original draws")
matplot(x, wwarp, type = "l", main = "Warped draws")
for (i in 1:reps)
wwarp[, i] <- deepgp:::monotransform(wwarp[, i, drop = FALSE], warp_ord)
deepgp:::monotransform
wwarp <- deepgp:::monotransform(wprior, warp_ord)
library(deepgp)
reps <- 10
n <- 50
x <- seq(0, 1, length = n)
warp_ord <- order(x, decreasing = FALSE)
dx <- sq_dist(x)
tau2 <- 1
theta <- 1
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
par(mfrow = c(1, 2))
matplot(x, wprior, type = "l", main = "Original draws")
matplot(x, wwarp, type = "l", main = "Warped draws")
library(deepgp)
reps <- 10
n <- 50
x <- seq(0, 1, length = n)
warp_ord <- order(x, decreasing = FALSE)
dx <- sq_dist(x)
tau2 <- 1
theta <- 1
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
par(mfrow = c(1, 2))
matplot(x, wprior, type = "l", main = "Original draws")
matplot(x, wwarp, type = "l", main = "Warped draws")
par(mfrow = c(4, 4), mar = c(2, 2, 1, 1))
for (tau2 in c(0.001, 0.01, 0.1, 1)) {
for (theta in c(0.001, 0.01, 0.1, 1)) {
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wwarp, type = "l", main = paste0("tau2 = ", tau2, " theta = ", theta))
}
}
par(mfrow = c(4, 4), mar = c(2, 2, 1, 1))
for (tau2 in c(0.001, 0.01, 0.1, 1)) {
for (theta in c(0.001, 0.01, 0.1, 1)) {
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wwarp, type = "l", ylim = c(-3, 3),
main = paste0("tau2 = ", tau2, " theta = ", theta))
}
}
par(mfrow = c(3, 3), mar = c(2, 2, 1, 1))
for (tau2 in c(0.01, 0.1, 1)) {
for (theta in c(0.01, 0.1, 1)) {
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wwarp, type = "l", ylim = c(-1, 1),
main = paste0("tau2 = ", tau2, " theta = ", theta))
}
}
tau2 <- 1
theta <- 1
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = x, sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
par(mfrow = c(1, 2))
matplot(x, wprior, type = "l", main = "Original draws")
matplot(x, wwarp, type = "l", main = "Warped draws")
par(mfrow = c(3, 3), mar = c(2, 2, 1, 1))
tau2 <- 1
theta <- 1
par(mfrow = c(2, 2))
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wprior, type = "l", main = "pm0, original")
matplot(x, wwarp, type = "l", main = "pm0, warped")
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = x, sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wprior, type = "l", main = "pmx, original")
matplot(x, wwarp, type = "l", main = "pmx, warped")
tau2 <- 0.01
theta <- 0.01
par(mfrow = c(2, 2))
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wprior, type = "l", main = "pm0, original")
matplot(x, wwarp, type = "l", main = "pm0, warped")
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = x, sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wprior, type = "l", main = "pmx, original")
matplot(x, wwarp, type = "l", main = "pmx, warped")
par(mfrow = c(3, 3), mar = c(2, 2, 1, 1))
for (tau2 in c(0.01, 0.1, 1)) {
for (theta in c(0.01, 0.1, 1)) {
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wwarp, type = "l", ylim = c(-1, 1),
main = paste0("pm0, tau2 = ", tau2, " theta = ", theta))
}
}
par(mfrow = c(3, 3), mar = c(2, 2, 1, 1))
for (tau2 in c(0.01, 0.1, 1)) {
for (theta in c(0.01, 0.1, 1)) {
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = x, sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wwarp, type = "l", ylim = c(-1, 1),
main = paste0("pmx, tau2 = ", tau2, " theta = ", theta))
}
}
par(mfrow = c(3, 3), mar = c(2, 2, 1, 1))
for (tau2 in c(0.01, 0.1, 1)) {
for (theta in c(0.01, 0.1, 1)) {
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = rep(0, n), sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wwarp, type = "l",
main = paste0("pm0, tau2 = ", tau2, " theta = ", theta))
}
}
par(mfrow = c(3, 3), mar = c(2, 2, 1, 1))
for (tau2 in c(0.01, 0.1, 1)) {
for (theta in c(0.01, 0.1, 1)) {
K <- deepgp:::Matern(dx, tau2, theta, 1e-6, 2.5)
wprior <- t(mvtnorm::rmvnorm(reps, mean = x, sigma = K))
wwarp <- deepgp:::monotransform(wprior, warp_ord)
matplot(x, wwarp, type = "l",
main = paste0("pmx, tau2 = ", tau2, " theta = ", theta))
}
}
setwd("~/llnl-dgp-git/varselect/tray")
library(deepgp)
library(lhs)
tray <- function(x) {
x <- x[, 1:2] # only first two inputs are relevant
x <- x*4 - 2
p1 <- abs(100 - sqrt(apply(x^2, 1, sum)) / pi)
p2 <- abs(apply(sin(x), 1, prod) * exp(p1)) + 1
y <- -0.0001 * (p2)^(0.1)
return((y + 1.9) / 0.2)
}
d <- 6 # 2 important, 4 dummy
n <- 100
np <- 500
reps <- 50
seed=1
set.seed(seed)
x <- randomLHS(n, d)
y <- tray(x)
xp <- randomLHS(np, d)
yp <- tray(xp)
# Fit mono DGP
fit <- fit_two_layer(x, y, nmcmc = 5000, monowarp = TRUE, pmx = TRUE)
plot(fit)
plot(fit, hidden = T)
fit <- trim(fit, 3000, 2)
plot(fit)
plot(fit, hidden = TRUE)
library(deepgp)
library(lhs)
tray <- function(x) {
x <- x[, 1:2] # only first two inputs are relevant
x <- x*4 - 2
p1 <- abs(100 - sqrt(apply(x^2, 1, sum)) / pi)
p2 <- abs(apply(sin(x), 1, prod) * exp(p1)) + 1
y <- -0.0001 * (p2)^(0.1)
return((y + 1.9) / 0.2)
}
d <- 5 # 2 important, 3 dummy
n <- 100
np <- 500
reps <- 50
set.seed(seed)
x <- randomLHS(n, d)
y <- tray(x)
xp <- randomLHS(np, d)
yp <- tray(xp)
# Fit mono DGP
fit <- fit_two_layer(x, y, nmcmc = 5000, monowarp = TRUE, pmx = TRUE)
plot(fit)
plot(fit, hidden = T)
fit <- trim(fit, 3000, 2)
plot(fit, hidden = T)
# Fit mono DGP
fit <- fit_two_layer(x, y, nmcmc = 5000, monowarp = TRUE)
plot(fit)
plot(fit, hidden = TRUE)
